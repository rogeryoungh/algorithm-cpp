<!DOCTYPE html>
<html><head>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <meta name="generator" content="Hugo 0.110.0-DEV">

  
  
  <link rel="stylesheet" href="/scss/index.min.95ba81376e079da48068412714d3b5b407c6cec0c5edbf6ebc255278b7938d7c.css">

</head>
<body>
  <div id="app"><header class="py-5 text-4 flex justify-center shadow print:hidden color-primary">
  <nav class="mx-20 w-full max-w-240 flex flex-wrap justify-center items-center whitespace-nowrap sm:flex-nowrap sm:justify-between">
    <div class="flex basis-full items-stretch justify-center sm:basis-auto">
      <img class="w-12 h-12 self-center" src="https://rogery.dev/img/logo.png">
      <a class="pl-5 font-bold flex self-center text-5" href="/"> Roger Young </a>
    </div>
    <ul class="pl-0 flex mt-5 self-center sm:mt-0">
      <button class="m-3 self-center" id="theme-switcher">
        <i class="i-carbon-automatic text-4">Sun</i>
      </button>
      
        <li class="flex"><a class="m-3" href="/">Home</a></li>
      
        <li class="flex"><a class="m-3" href="/post/base/">List</a></li>
      
        <li class="flex"><a class="m-3" href="/post">Post</a></li>
      
        <li class="flex"><a class="m-3" href="https://github.com/rogeryoungh/algorithm-cpp">ğŸ¤© GitHub</a></li>
      
    </ul>
  </nav>
</header>


<main class="px-5 flex justify-center">
  <article class="article w-full max-w-210 my-10">
    <header class="my-20">
      <h1 class="text-8 text-center folt-bold"> Lucas ç´ æ€§æµ‹è¯• </h1>
      <a
        class="text-center-my-6 hidden print:block"
        href="https://rogery.dev/">
        rogeryoungh
      </a>
      <div class="text-center">
        
        
        2023 å¹´ 1 æœˆ 21 æ—¥
        
      </div>
    </header>
    
      <h1> ç›®å½• </h1><nav id="TableOfContents">
  <ol>
    <li><a href="#ç†è®º">ç†è®º</a></li>
    <li><a href="#ç®—æ³•æè¿°">ç®—æ³•æè¿°</a></li>
    <li><a href="#å¤‡æ³¨">å¤‡æ³¨</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
    <li><a href="#ä»£ç ">ä»£ç </a></li>
  </ol>
</nav>
    <section class="content-frame my-10">
      <h2 id="ç†è®º">ç†è®º</h2>
<p>è®¾  $D$  ä¸ºæ— å¹³æ–¹æ•´æ•°ï¼Œè®°  $O$  ä¸ºäºŒæ¬¡åŸŸ  $\mathbb{Q}(\sqrt{D})$  ä¸Šçš„ <a href="https://www.bananaspace.org/wiki/%E4%BB%A3%E6%95%B0%E6%95%B4%E6%95%B0">ä»£æ•°æ•´æ•°ç¯</a>ï¼Œæœ‰ç±»æ¯”çš„å®šç†ï¼š</p>
<p>ã€äºŒæ¬¡åŸŸä¸­çš„ Fermat å°å®šç†ã€‘è®¾  $a \in O$ ï¼Œ $p$  ä¸ºå¥‡ç´ æ•°ï¼Œä¸”  $p \nmid d$ ï¼Œåˆ™</p>
<p> $$
a^p = \begin{cases} a, &\text{è‹¥ } \left(\frac{D}{p}\right) = 1 \\ \overline{a}, &\text{è‹¥ } \left(\frac{D}{p}\right) = -1\end{cases} \pmod p
$$ </p>
<p>ç”±äºä¹˜å¹‚å¹¶ä¸å®¹æ˜“è®¡ç®—ï¼Œå¼•å…¥ä¸€ç±»ç‰¹æ®Šçš„äºŒé˜¶é€’æ¨åºåˆ—ï¼šè®¾  $P, Q \in \mathbb{Z}$ ï¼Œç‰¹å¾æ–¹ç¨‹  $x^2 - Px+ Q = 0$  çš„ä¸¤æ ¹åˆ†åˆ«ä¸º  $a, b$ ï¼Œå®šä¹‰  $P, Q$  å¯¹åº”çš„ Lucas åºåˆ—ä¸º</p>
<p> $$
U_n = \frac{a^n - b^n}{a - b},\quad V_n = a^n + b^n
$$ </p>
<blockquote>
<p>æˆ‘æ²¡ç†è§£ä¹˜å¹‚è®¡ç®—çš„åœ¨å“ªé‡Œæœ‰å›°éš¾ï¼Œä¸èƒ½å¿«é€Ÿå¹‚å—ï¼ŸçŒœæµ‹æ˜¯é‚£ä¸ªé™¤  $2$  æ¯”è¾ƒå¤´ç–¼ã€‚</p>
</blockquote>
<p>å…¶ä¸äºŒæ¬¡åŸŸçš„å…³ç³»æ˜¯</p>
<p> $$
\left(\frac{P + \sqrt{D}}{2}\right)^n = \frac{V_n + U_n \sqrt{D}}{2}, \quad D = P^2 - 4Q
$$ </p>
<p>é¦–å…ˆæˆ‘ä»¬é™å®š  $\gcd(QD, p) = 1$ ï¼Œä¿è¯  $a,b,a-b$  åœ¨æ¨¡  $p$  ä¸‹å¯é€†ã€‚å†è®°  $\varepsilon = \left(\frac{D}{p}\right)$ ï¼Œä¸éš¾æ ¹æ® Fermat å°å®šç†è¯æ˜  $U_{p - \varepsilon} \equiv 0 \pmod p$ ã€‚</p>
<h2 id="ç®—æ³•æè¿°">ç®—æ³•æè¿°</h2>
<p>è¾“å…¥å¥‡æ•°  $N$ ï¼Œé€‰å–  $P, Q$  ä½œä¸º Lucas åºåˆ—å‚æ•°ï¼Œä½¿å¾—  $\varepsilon = \left(\frac{D}{N}\right) \neq 0$ ã€‚</p>
<ol>
<li>è‹¥  $U_{N - \varepsilon} \equiv 0 \pmod N$ ï¼Œåˆ™è¾“å‡º  $N$  å¯èƒ½ä¸ºå¥‡ç´ æ•°ã€‚</li>
<li>è‹¥  $U_{N - \varepsilon} \not\equiv 0 \pmod N$ ï¼Œåˆ™è¾“å‡º  $N$  ä¸ºåˆæ•°ã€‚</li>
</ol>
<p>ç”±äº  $2$  åœ¨å¥‡æ•°ä¸‹çš„é€†å…ƒæ€»æ˜¯å­˜åœ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŸ©é˜µå¿«é€Ÿå¹‚è®¡ç®—ä¸Šå¼ã€‚</p>
<p>å¯¹äº  $P,Q$  çš„é€‰å–ï¼Œæœ‰ä¸¤ç§å»ºè®®ï¼š</p>
<ol>
<li>Selfridge å»ºè®®ï¼šå–  $D$  ä¸º  $5, -7, 9, -11,13,\cdots$  ä¸­ä½¿å¾—  $\left(\frac{D}{N}\right) = -1$  çš„ç¬¬ä¸€ä¸ªæ•°ï¼Œé€‰æ‹©  $P = 1, Q = \frac{1-D}{2}$ ã€‚</li>
<li>Baillie å»ºè®®ï¼šå–  $D$  ä¸º  $5, 9, 13, 17, 21, \cdots$  ä¸­ä½¿å¾—ä½¿å¾—  $\left(\frac{D}{N}\right) = -1$  çš„ç¬¬ä¸€ä¸ªæ•°ï¼Œé€‰æ‹©  $P$  ä¸ºå¤§äº  $\sqrt{D}$  çš„æœ€å°å¥‡æ•°ï¼Œ $Q = \frac{P^2 - D}{4}$ ã€‚</li>
</ol>
<p>è®ºæ–‡ä¸­æåˆ°ï¼Œå–åˆ°åˆé€‚çš„  $D$  çš„æœŸæœ›æ¬¡æ•°ä¸º  $2$ ã€‚è‹¥å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œåˆ™è¯´æ˜  $N$  å¾ˆå¯èƒ½æ˜¯å¹³æ–¹æ•°ï¼Œéœ€è¦æ£€æµ‹ä¸‹ã€‚</p>
<h2 id="å¤‡æ³¨">å¤‡æ³¨</h2>
<p>ç½‘ä¸Šæ‰¾åˆ°çš„å¾ˆå¤š Lucas æ£€æµ‹ä»£ç éƒ½æ˜¯å…³äº  $n+1$  çš„å› å¼åˆ†è§£ï¼Œæˆ‘è¦æ˜¯èƒ½åˆ†è§£è¿˜åˆ¤ç´ æ•°å¹²å˜›ã€‚ã€‚</p>
<p>ä¼¼ä¹å¤§å®¶éƒ½å»ºè®®å›ºå®š  $D$ ï¼Œç„¶å  $(p, q) \to (p + 2, p + q + 1)$  è¿™æ ·ï¼Œä½†æ˜¯é€šä¸è¿‡ <a href="https://loj.ac/p/143">LOJ143</a>ï¼Œè€Œä¸”åä¾‹å¾ˆå¤šçš„æ ·å­ã€‚ã€‚ã€‚åæ­£è®¡ç®— Jacobi çš„å¤æ‚åº¦æ˜¯  $O(\log^2 n)$  çš„ï¼Œä¸å¦‚æ¢  $D$ ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="http://mathmu.github.io/MTCAS/doc/PrimeTest.html">ç´ æ•°åˆ¤å®š - mathmu</a></li>
<li><a href="https://www.zhihu.com/question/308322307/answer/574767625">å¦‚ä½•ç¼–ç¨‹åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°ï¼Ÿ - Wiener ESçš„å›ç­”</a></li>
<li><a href="https://primes.utm.edu/prove/prove3_2.html">Primality Proving 3.2 n+1 tests and the Lucas-Lehmer test</a></li>
</ul>
<h2 id="ä»£ç ">ä»£ç </h2>



<pre><code class="language-cpp">#ifndef ALGO_MATH_LUCAS_TEST
#define ALGO_MATH_LUCAS_TEST

#include &quot;../../base.hpp&quot;
#include &quot;../qpow/u64.hpp&quot;
#include &quot;../jacobi.hpp&quot;
#include &quot;../square-test.hpp&quot;

#include &lt;functional&gt;

bool lucas_test_pd(u64 N, u64 P, u64 D) { // jacobi(D, N) == -1
  using pii = std::pair&lt;u64, u64&gt;;
  auto shift2 = [N](u64 n) {
    return n % 2 == 0 ? n / 2 : (N + n) / 2;
  };
  std::function&lt;pii(u64)&gt; calc = [&amp;](u64 n) {
    if (n == 1)
      return pii{P, 1};
    auto [v, u] = calc(n / 2);
    u64 u2 = u128(u) * v % N;
    u64 v2 = (u128(v) * v + u128(u) * u % N * D) % N;
    v2 = shift2(v2);
    if (n % 2 == 1) {
      u64 u21 = (u128(P) * u2 + v2) % N;
      u64 v21 = (u128(D) * u2 + u128(P) * v2) % N;
      u2 = shift2(u21), v2 = shift2(v21);
    }
    return pii{v2, u2};
  };
  auto [v, u] = calc(N + 1);
  return u == 0;
}

bool lucas_test(u64 n) {
  if (n &lt;= 6)
    return n == 2 || n == 3 || n == 5;
  if (n % 6 != 1 &amp;&amp; n % 6 != 5)
    return false;
  if (square_test(n))
    return false;
  for (u64 d = 5, c = 0; d &lt; n &amp;&amp; c &lt; 4; d += 4) {
    i32 j = jacobi(d, n);
    if (j == 0)
      return false;
    if (j == 1)
      continue;
    if (!lucas_test_pd(n, d, d))
      return false;
    c++;
  }
  return true;
}

#endif // ALGO_MATH_LUCAS_TEST

</code></pre>



    </section>
    <hr />
    <section class="comment-frame my-10">
      



    </section>
  </article>
</main>


<footer class="my-10 color-secondary text-3 flex items-end justify-center a-underline">
  <span>
    Â© 2023 <a href="https://rogery.dev">Roger Young</a>
  </span>
  <i class="i-carbon-lighting inline-block px-1"></i>
  <span>Powered by <a href="https://gohugo.io/">Hugo</a> &
    <a href="https://github.com/rogeryoungh/hugo-pure">pure</a>
  </span>
</footer>
</div>
  <div>
    
  <link
  crossorigin="anonymous"
  integrity="sha512-mQwom8Ns4op+H29oDkD/LXO/OsXPvCFfkgZkFAVrhhePzRLU8NUI3Nkm43NhWUSmj3p5Cca2HTEkMQmXQRwDQQ=="
  href="https://lib.baomitu.com/KaTeX/0.16.4/katex.min.css" rel="stylesheet">
<script
  crossorigin="anonymous"
  integrity="sha512-sHSNLECRJSK+BFs7E8DiFc6pf6n90bLI85Emiw1jhreduZhK3VXgq9l4kAt9eTIHYAcuQBKHL01QKs4/3Xgl8g=="
  src="https://lib.baomitu.com/KaTeX/0.16.4/katex.min.js"></script>
<script
  crossorigin="anonymous"
  integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg=="
  src="https://lib.baomitu.com/KaTeX/0.16.4/contrib/auto-render.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  renderMathInElement(document.body, {
    delimiters: [
      { left: '$$', right: '$$', display: true },
      { left: '$', right: '$', display: false },
      { left: '\\(', right: '\\)', display: false },
      { left: '\\[', right: '\\]', display: true },
    ],
    globalGroup: true,
    throwOnError: false
  });
});
</script>




  <script
  crossorigin="anonymous"
  src="https://lib.baomitu.com/prism/1.29.0/prism.min.js"></script>
<script
  crossorigin="anonymous"
  src="https://lib.baomitu.com/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script>
let themeSwitch = document.getElementById("theme-switcher");
var icon = themeSwitch.children[0];
let currentPref = localStorage.getItem('pref-theme') || 'auto';
let html = document.documentElement;
let windowPref = window.matchMedia('(prefers-color-scheme: dark)');
function isCurrentDark() {
  let isDark = false;
  if (currentPref === 'light') {
    isDark = false;
  } else if (currentPref === 'dark') {
    isDark = true;
  } else {
    isDark = windowPref.matches;
  }
  return isDark;
}
let reloadTheme = () => {
  icon.classList.remove('i-carbon-moon');
  icon.classList.remove('i-carbon-sun');
  icon.classList.remove('i-carbon-automatic');
  if (currentPref === 'light') {
    icon.classList.add('i-carbon-sun');
  } else if (currentPref === 'dark') {
    icon.classList.add('i-carbon-moon');
  } else {
    icon.classList.add('i-carbon-automatic');
  }
  if (isCurrentDark()) {
    html.classList.add('dark');
  } else {
    html.classList.remove('dark');
  }
  
};
themeSwitch.addEventListener("click", () => {
  icon.classList.remove('i-carbon-moon');
  icon.classList.remove('i-carbon-sun');
  icon.classList.remove('i-carbon-automatic');
  if (currentPref === 'auto') {
    currentPref = 'dark';
    icon.classList.add('i-carbon-moon');
  } else if (currentPref === 'dark') {
    currentPref = 'light';
    icon.classList.add('i-carbon-sun');
  } else {
    currentPref = 'auto';
    icon.classList.add('i-carbon-automatic');
  }
  localStorage.setItem("pref-theme", currentPref);
  reloadTheme();
});
reloadTheme();
</script>


  </div>
</body>

</html>
